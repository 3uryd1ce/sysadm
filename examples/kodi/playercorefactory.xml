<playercorefactory>

  <players>

    <!-- add mpv as an option for both audio and video -->
    <player name="mpv" type="ExternalPlayer" audio="true" video="true">
      <filename>/usr/local/bin/mpv</filename>
      <hidexbmc>false</hidexbmc>
    </player>

    <!-- for video only, provide rgba12 as an option in case mpv is struggling -->
    <player name="mpv (rgba12)" type="ExternalPlayer" audio="false" video="true">
      <filename>/usr/local/bin/mpv</filename>
      <args>--fbo-format=rgba12 "{1}"</args>
      <hidexbmc>false</hidexbmc>
    </player>

    <!--
       -for video only, provide rgb10_a2 as an option in case mpv is struggling even more.
       -
       -below rgb10_a2, the video quality suffers too much.
       -->
    <player name="mpv (rgb10_a2)" type="ExternalPlayer" audio="false" video="true">
      <filename>/usr/local/bin/mpv</filename>
      <args>--fbo-format=rgb10_a2 "{1}"</args>
      <hidexbmc>false</hidexbmc>
    </player>

  </players>

  <rules action="prepend">

    <!--
       -mpv is unable to perform hardware video acceleration for HEVC,
       -so use the default Kodi player for those videos since it does have HEVC
       -hardware video acceleration.
       -->
    <rule video="true" videocodec="(hevc|HEVC)" player="VideoPlayer"/>

    <!-- mpv is to play any video that doesn't match the above. -->
    <rule video="true" player="mpv"/>

  </rules>

</playercorefactory>
